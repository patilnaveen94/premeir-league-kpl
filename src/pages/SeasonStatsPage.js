import React, { useState, useEffect } from 'react';\nimport { collection, getDocs } from 'firebase/firestore';\nimport { db } from '../firebase/firebase';\nimport { Trophy, Target, Activity, TrendingUp } from 'lucide-react';\n\nconst SeasonStatsPage = () => {\n  const [playerStats, setPlayerStats] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [activeTab, setActiveTab] = useState('season');\n  const currentSeason = new Date().getFullYear().toString();\n\n  useEffect(() => {\n    fetchPlayerStats();\n  }, []);\n\n  const fetchPlayerStats = async () => {\n    try {\n      const statsSnapshot = await getDocs(collection(db, 'playerStats'));\n      const stats = statsSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n      \n      // Sort by runs (season or career based on active tab)\n      const sortedStats = stats.sort((a, b) => {\n        const runsA = activeTab === 'season' ? (a.runs || 0) : (a.careerRuns || 0);\n        const runsB = activeTab === 'season' ? (b.runs || 0) : (b.careerRuns || 0);\n        return runsB - runsA;\n      });\n      \n      setPlayerStats(sortedStats);\n    } catch (error) {\n      console.error('Error fetching player stats:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Re-fetch and re-sort when tab changes\n  useEffect(() => {\n    if (playerStats.length > 0) {\n      const sortedStats = [...playerStats].sort((a, b) => {\n        const runsA = activeTab === 'season' ? (a.runs || 0) : (a.careerRuns || 0);\n        const runsB = activeTab === 'season' ? (b.runs || 0) : (b.careerRuns || 0);\n        return runsB - runsA;\n      });\n      setPlayerStats(sortedStats);\n    }\n  }, [activeTab]);\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-cricket-green mx-auto\"></div>\n          <p className=\"mt-4 text-gray-600\">Loading player statistics...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 py-8\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n        {/* Header */}\n        <div className=\"text-center mb-8\">\n          <h1 className=\"text-4xl font-bold text-gray-900 mb-4\">Player Statistics</h1>\n          <p className=\"text-lg text-gray-600\">Complete performance analysis for all players</p>\n        </div>\n\n        {/* Tab Navigation */}\n        <div className=\"bg-white rounded-lg shadow-lg mb-8\">\n          <div className=\"border-b border-gray-200\">\n            <nav className=\"flex justify-center space-x-8 p-4\">\n              <button\n                onClick={() => setActiveTab('season')}\n                className={`flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all ${\n                  activeTab === 'season'\n                    ? 'bg-cricket-green text-white shadow-md'\n                    : 'text-gray-600 hover:text-cricket-green hover:bg-gray-50'\n                }`}\n              >\n                <Activity size={20} />\n                <span>Current Season ({currentSeason})</span>\n              </button>\n              <button\n                onClick={() => setActiveTab('career')}\n                className={`flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-all ${\n                  activeTab === 'career'\n                    ? 'bg-cricket-green text-white shadow-md'\n                    : 'text-gray-600 hover:text-cricket-green hover:bg-gray-50'\n                }`}\n              >\n                <Trophy size={20} />\n                <span>Career Stats</span>\n              </button>\n            </nav>\n          </div>\n        </div>\n\n        {/* Stats Table */}\n        <div className=\"bg-white rounded-lg shadow-lg overflow-hidden\">\n          <div className=\"px-6 py-4 bg-gradient-to-r from-cricket-navy to-cricket-blue\">\n            <h2 className=\"text-xl font-bold text-white flex items-center\">\n              {activeTab === 'season' ? (\n                <><Activity className=\"mr-2\" size={24} /> Current Season Statistics</>\n              ) : (\n                <><Trophy className=\"mr-2\" size={24} /> Career Statistics</>\n              )}\n            </h2>\n          </div>\n          \n          <div className=\"overflow-x-auto\">\n            <table className=\"min-w-full divide-y divide-gray-200\">\n              <thead className=\"bg-gray-50\">\n                <tr>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Rank</th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Player</th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Team</th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Matches</th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Runs</th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Avg</th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">SR</th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">4s/6s</th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Wickets</th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Economy</th>\n                </tr>\n              </thead>\n              <tbody className=\"bg-white divide-y divide-gray-200\">\n                {playerStats.map((player, index) => {\n                  const isCareer = activeTab === 'career';\n                  const matches = isCareer ? (player.careerMatches || 0) : (player.matches || 0);\n                  const runs = isCareer ? (player.careerRuns || 0) : (player.runs || 0);\n                  const average = isCareer ? (player.careerAverage || '0.00') : (player.average || '0.00');\n                  const strikeRate = isCareer ? (player.careerStrikeRate || '0.00') : (player.strikeRate || '0.00');\n                  const fours = isCareer ? (player.careerFours || 0) : (player.fours || 0);\n                  const sixes = isCareer ? (player.careerSixes || 0) : (player.sixes || 0);\n                  const wickets = isCareer ? (player.careerWickets || 0) : (player.wickets || 0);\n                  const economy = isCareer ? (player.careerEconomy || '0.00') : (player.economy || '0.00');\n                  \n                  return (\n                    <tr key={player.id} className={`hover:bg-gray-50 ${\n                      index < 3 ? 'bg-gradient-to-r from-yellow-50 to-orange-50' : ''\n                    }`}>\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\n                        <div className=\"flex items-center\">\n                          {index < 3 && (\n                            <div className={`w-8 h-8 rounded-full flex items-center justify-center text-white font-bold mr-2 ${\n                              index === 0 ? 'bg-yellow-500' :\n                              index === 1 ? 'bg-gray-400' :\n                              'bg-orange-600'\n                            }`}>\n                              {index + 1}\n                            </div>\n                          )}\n                          {index >= 3 && (\n                            <span className=\"text-gray-600 font-medium\">{index + 1}</span>\n                          )}\n                        </div>\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\n                        <div className=\"font-medium text-gray-900\">{player.name}</div>\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\n                        <span className=\"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full\">\n                          {player.team}\n                        </span>\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                        {matches}\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\n                        <div className=\"flex items-center\">\n                          <Target className=\"w-4 h-4 text-cricket-green mr-1\" />\n                          <span className=\"font-semibold text-cricket-navy\">{runs}</span>\n                        </div>\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                        {average}\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                        {strikeRate}\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                        <span className=\"text-green-600 font-medium\">{fours}</span>\n                        <span className=\"text-gray-400 mx-1\">/</span>\n                        <span className=\"text-blue-600 font-medium\">{sixes}</span>\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                        {wickets}\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                        {economy}\n                      </td>\n                    </tr>\n                  );\n                })}\n              </tbody>\n            </table>\n          </div>\n          \n          {playerStats.length === 0 && (\n            <div className=\"text-center py-12\">\n              <TrendingUp className=\"mx-auto h-12 w-12 text-gray-400\" />\n              <h3 className=\"mt-2 text-sm font-medium text-gray-900\">No statistics available</h3>\n              <p className=\"mt-1 text-sm text-gray-500\">Player statistics will appear here once matches are completed.</p>\n            </div>\n          )}\n        </div>\n\n        {/* Summary Cards */}\n        {playerStats.length > 0 && (\n          <div className=\"mt-8 grid grid-cols-1 md:grid-cols-3 gap-6\">\n            <div className=\"bg-white rounded-lg shadow-lg p-6\">\n              <div className=\"flex items-center\">\n                <div className=\"flex-shrink-0\">\n                  <Trophy className=\"h-8 w-8 text-yellow-500\" />\n                </div>\n                <div className=\"ml-4\">\n                  <h3 className=\"text-lg font-medium text-gray-900\">Top Scorer</h3>\n                  <p className=\"text-2xl font-bold text-cricket-navy\">\n                    {playerStats[0]?.name} ({activeTab === 'career' ? playerStats[0]?.careerRuns : playerStats[0]?.runs} runs)\n                  </p>\n                </div>\n              </div>\n            </div>\n            \n            <div className=\"bg-white rounded-lg shadow-lg p-6\">\n              <div className=\"flex items-center\">\n                <div className=\"flex-shrink-0\">\n                  <Activity className=\"h-8 w-8 text-green-500\" />\n                </div>\n                <div className=\"ml-4\">\n                  <h3 className=\"text-lg font-medium text-gray-900\">Total Players</h3>\n                  <p className=\"text-2xl font-bold text-cricket-navy\">{playerStats.length}</p>\n                </div>\n              </div>\n            </div>\n            \n            <div className=\"bg-white rounded-lg shadow-lg p-6\">\n              <div className=\"flex items-center\">\n                <div className=\"flex-shrink-0\">\n                  <Target className=\"h-8 w-8 text-blue-500\" />\n                </div>\n                <div className=\"ml-4\">\n                  <h3 className=\"text-lg font-medium text-gray-900\">Total Runs</h3>\n                  <p className=\"text-2xl font-bold text-cricket-navy\">\n                    {playerStats.reduce((total, player) => {\n                      const runs = activeTab === 'career' ? (player.careerRuns || 0) : (player.runs || 0);\n                      return total + runs;\n                    }, 0)}\n                  </p>\n                </div>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default SeasonStatsPage;